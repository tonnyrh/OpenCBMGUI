# OpenCBM GUI

OpenCBM GUI is a graphical user interface for the OpenCBM software, which allows users to interact with Commodore disk drives. This GUI is built using PowerShell and Windows Forms, providing an intuitive way to manage disk operations without using the command line.

## Features

- Detect connected Commodore disk drives.
- Initialize and reset drives.
- Display directory contents of the disk.
- Transfer files to and from the drive.
- Format disks with custom options.
- Support for various copy methods including `d64copy`, `d82copy`, `imgcopy`, and `cbmcopy`.

## Prerequisites

- Windows operating system.
- [OpenCBM](http://spiro.trikaliotis.net/opencbm) installed in `C:\Program Files\opencbm`.
- PowerShell.

## Installation

1. Clone the repository:
    ```sh
    git clone https://github.com/yourusername/opencbm-gui.git
    ```

2. Navigate to the project directory:
    ```sh
    cd opencbm-gui
    ```

3. Adjust PowerShell execution policy (if not already set):
    ```sh
    Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
    ```
    Note: You may need to run PowerShell as an administrator to change the execution policy.

4. Run the PowerShell script:
    ```sh
    .\opencbmGUI.ps1
    ```

## Usage

1. **Initialize Drive**: Click the "Initialize Drive" button to reset the selected drive.

2. **Detect Drive**: Click the "Detect Drive" button to detect and select the connected drive automatically.

3. **Display Directory**: Click the "Dir" button to display the directory contents of the disk.

4. **Transfer to Drive**:
    - Select the copy method from the dropdown.
    - Click the "Transfer to Drive" button.
    - Choose the file to transfer from your computer to the disk drive.

5. **Transfer from Drive**:
    - Select the copy method from the dropdown.
    - Click the "Transfer from Drive" button.
    - Enter the filename on the Commodore drive.
    - Choose the destination file on your computer to save the transferred file.

6. **Test Drive**: Click the "Test Drive" button to test the connection with the drive.

7. **Format Disk**:
    - Enter the disk name and disk ID.
    - Check the "Verify" and "Use cbmforng" options if needed.
    - Click the "Format Disk" button to format the disk with the specified options.

## Creating an Icon for the Application

To create an icon for the OpenCBM GUI application:

1. Create a shortcut for the PowerShell script:
    - Right-click on the `opencbmGUI.ps1` file.
    - Select "Create shortcut".

2. Change the icon of the shortcut:
    - Right-click on the created shortcut and select "Properties".
    - Go to the "Shortcut" tab and click on "Change Icon...".
    - Choose an icon file (`.ico`) from your computer or use a default one from Windows.
    - Click "OK" and then "Apply".

3. (Optional) Move the shortcut to a convenient location, like the Desktop or Start Menu.

## Example Commands

Here are some example commands generated by the GUI:

- Detect a connected drive:
    ```sh
    "C:\Program Files\opencbm\cbmctrl" detect
    ```

- Transfer a file to the drive using `d64copy`:
    ```sh
    "C:\Program Files\opencbm\d64copy" "path\to\file.d64" 8
    ```

- Transfer a file from the drive using `cbmcopy`:
    ```sh
    "C:\Program Files\opencbm\cbmcopy" -r 8 cbmfile -o "path\to\file.bin"
    ```

## Contributing

Contributions are welcome! Please fork the repository and submit a pull request with your changes. Ensure your code follows the project's coding standards and includes appropriate tests.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

## Acknowledgments

- [OpenCBM](http://spiro.trikaliotis.net/opencbm) for the backend software.
- The Commodore community for keeping the legacy alive.

---

*OpenCBM GUI v0.1 by dotBtty*
